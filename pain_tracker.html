<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç–¼ç—›ç›£æ§èˆ‡èª¿æ•´ç³»çµ±</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f7f9fc; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; }
        h1 { font-size: 1.5rem; text-align: center; color: #2c3e50; margin-bottom: 5px; }
        h2 { font-size: 1.1rem; color: #555; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; }
        .subtitle { text-align: center; color: #7f8c8d; font-size: 0.9rem; margin-bottom: 20px; }
        
        .slider-container { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; display: flex; justify-content: space-between; }
        input[type=range] { width: 100%; cursor: pointer; }
        .val-display { color: #3498db; font-weight: bold; }
        
        button { width: 100%; padding: 15px; background-color: #3498db; color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: background 0.3s; }
        button:hover { background-color: #2980b9; }
        
        #result-area { display: none; margin-top: 20px; animation: fadeIn 0.5s; }
        .status-box { padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 6px solid; }
        .status-red { background-color: #ffeaea; border-color: #e74c3c; color: #c0392b; }
        .status-yellow { background-color: #fff8e1; border-color: #f1c40f; color: #f39c12; }
        .status-green { background-color: #e8f8f5; border-color: #27ae60; color: #27ae60; }
        
        .advice-box { background: #f8f9fa; padding: 15px; border-radius: 8px; font-size: 0.95rem; line-height: 1.6; }
        .advice-title { font-weight: bold; margin-bottom: 5px; color: #2c3e50; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <h1>ğŸ‹ï¸ ç–¼ç—›ç›£æ§èˆ‡èª¿æ•´ç³»çµ±</h1>
    <div class="subtitle">Rehab & Performance Monitoring</div>

    <div class="card">
        <h2>1. è¼¸å…¥æ•¸æ“š (VAS 0-10)</h2>
        
        <div class="slider-container">
            <label>é‹å‹•å‰åŸºæº– (Baseline) <span id="val-before" class="val-display">0</span></label>
            <input type="range" id="before" min="0" max="10" value="0" oninput="updateVal('before')">
        </div>
        
        <div class="slider-container">
            <label>é‹å‹•ä¸­æœ€é«˜å€¼ (During) <span id="val-during" class="val-display">0</span></label>
            <input type="range" id="during" min="0" max="10" value="0" oninput="updateVal('during')">
        </div>
        
        <div class="slider-container">
            <label>é‹å‹•å‰›çµæŸ (Post) <span id="val-after" class="val-display">0</span></label>
            <input type="range" id="after" min="0" max="10" value="0" oninput="updateVal('after')">
        </div>
        
        <div class="slider-container">
            <label>éš”å¤© 24hr å¾Œ (Next Day) <span id="val-next" class="val-display">0</span></label>
            <input type="range" id="next" min="0" max="10" value="0" oninput="updateVal('next')">
        </div>

        <button onclick="analyze()">ğŸ“Š åˆ†æä¸¦å–å¾—å»ºè­°</button>
    </div>

    <div id="result-area">
        <div id="status-box" class="status-box"></div>
        
        <div class="card">
            <canvas id="painChart"></canvas>
        </div>

        <div class="card advice-box">
            <div class="advice-title">ğŸ’¡ è¨“ç·´å»ºè­°ï¼š</div>
            <div id="advice-text"></div>
            <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
            <div class="advice-title">ğŸ” æ©Ÿåˆ¶èªªæ˜ï¼š</div>
            <div id="mechanism-text" style="color:#666; font-size:0.9rem;"></div>
        </div>
    </div>

    <script>
        function updateVal(id) {
            document.getElementById('val-' + id).innerText = document.getElementById(id).value;
        }

        let myChart = null;

        function analyze() {
            // å–å¾—æ•¸å€¼
            const before = parseInt(document.getElementById('before').value);
            const during = parseInt(document.getElementById('during').value);
            const after = parseInt(document.getElementById('after').value);
            const next = parseInt(document.getElementById('next').value);

            const baselineDiff = next - before;
            let result = {};

            // é‚è¼¯åˆ¤æ–· (Traffic Light)
            if (baselineDiff > 0 || during > 5) {
                result = {
                    color: 'red',
                    title: 'ğŸ”´ ç´…ç‡ˆï¼šè² è·éé‡ (Overload)',
                    advice: 'è«‹é™ä½å¼·åº¦æˆ–æ”¹è®Šå‹•ä½œï¼Œç›´åˆ°ç–¼ç—›å›åˆ°åŸºæº–ç·šã€‚<br>æ‚¨çš„çµ„ç¹”è€å—åº¦å·²è¶…éæ¥µé™ã€‚',
                    mechanism: 'éš”å¤©ç–¼ç—›é«˜æ–¼åŸºæº–ï¼Œä»£è¡¨ç™¼ç‚åæ‡‰æœªåœ¨ 24 å°æ™‚å…§æ¶ˆé€€ï¼›æˆ–ç•¶ä¸‹ç–¼ç—›éé«˜å½±éŸ¿æ§åˆ¶ã€‚',
                    cssClass: 'status-red'
                };
            } else if ((during >= 4 || after >= 4) && baselineDiff <= 0) {
                result = {
                    color: 'yellow',
                    title: 'ğŸŸ¡ é»ƒç‡ˆï¼šè§€å¯ŸæœŸ (Monitor)',
                    advice: 'ç¶­æŒç›®å‰å¼·åº¦ï¼Œä¸è¦å¢åŠ è² è·ã€‚å¯†åˆ‡è§€å¯Ÿä¸‹ä¸€æ¬¡åæ‡‰ã€‚<br>é€™æ˜¯èº«é«”é©æ‡‰çš„è‡¨ç•Œé»ã€‚',
                    mechanism: 'é›–æœ‰ä¸­åº¦ç–¼ç—›ï¼Œä½†éš”å¤©å·²æ¢å¾©ã€‚ä»£è¡¨åŠ‘é‡å¯å¸æ”¶ä½†è™•æ–¼é‚Šç·£ã€‚',
                    cssClass: 'status-yellow'
                };
            } else {
                result = {
                    color: 'green',
                    title: 'ğŸŸ¢ ç¶ ç‡ˆï¼šå®‰å…¨å¯é€²éš (Safe)',
                    advice: 'å¯ç¶­æŒç›®å‰å¼·åº¦ï¼Œæˆ–å˜—è©¦å¾®å¹…å¢åŠ é‡é‡/æ¬¡æ•¸ã€‚<br>ç¥ç¶“è‚Œè‚‰ç³»çµ±é©æ‡‰è‰¯å¥½ã€‚',
                    mechanism: 'ç–¼ç—›æ§åˆ¶è‰¯å¥½ï¼Œä¸”ç„¡å»¶é²æ€§ç™¼ç‚åæ‡‰ã€‚',
                    cssClass: 'status-green'
                };
            }

            // æ›´æ–°ä»‹é¢
            const resArea = document.getElementById('result-area');
            const statusBox = document.getElementById('status-box');
            
            resArea.style.display = 'block';
            statusBox.className = 'status-box ' + result.cssClass;
            statusBox.innerHTML = `<h3>${result.title}</h3>`;
            
            document.getElementById('advice-text').innerHTML = result.advice;
            document.getElementById('mechanism-text').innerText = result.mechanism;

            // ç¹ªè£½åœ–è¡¨
            updateChart(before, during, after, next, result.color);
            
            // æ²å‹•åˆ°çµæœ
            resArea.scrollIntoView({behavior: "smooth"});
        }

        function updateChart(b, d, a, n, statusColor) {
            const ctx = document.getElementById('painChart').getContext('2d');
            
            let lineColor = '#27ae60'; // green
            if(statusColor === 'red') lineColor = '#c0392b';
            if(statusColor === 'yellow') lineColor = '#f39c12';

            if (myChart) myChart.destroy();

            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Baseline', 'During', 'Post', 'Next Day'],
                    datasets: [{
                        label: 'ç–¼ç—›è®ŠåŒ– (VAS)',
                        data: [b, d, a, n],
                        borderColor: lineColor,
                        backgroundColor: lineColor,
                        borderWidth: 3,
                        pointRadius: 5,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, max: 10, title: {display:true, text:'VAS Score'} }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }
    </script>
</body>
</html>
